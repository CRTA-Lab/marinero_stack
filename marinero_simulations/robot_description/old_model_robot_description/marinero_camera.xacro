<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="camera">

    <joint name="camera_base_joint" type="revolute">
        <origin xyz="0.0 -0.2375 0.430" rpy="0 0 ${-pi/2}" />
        <parent link="chassis" />
        <child link="camera_base" />
        <axis xyz="0 0 -1" />
        <limit
            upper="${pi}"
            lower="-${pi}"
            effort="100"
            velocity="100" />
        <!-- <dynamics damping="0.1" /> -->
        <dynamics damping="10.0" friction="5.0" />
    </joint>

    <link name="camera_base">
        <visual>
            <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://marinero_simulations/robot_description/meshes/Camera_Base.stl" scale="1.0 1.0 1.0"/>
            </geometry>
            <material name="dark"/>
        </visual>

        <collision>
            <origin xyz="0.0 0.0 0.095"/>
            <geometry>
                <cylinder length="0.192" radius="0.1"/>
            </geometry>
        </collision>
        
        <inertial>
            <origin xyz="-0.000476 0.00075 0.102423" rpy="0.0 0.0 0.0"/>
            <mass value="0.333" />
            <inertia ixx="5.989e-4" ixy="-1.241e-11" ixz="1.199e-6"
                    iyx="-1.241e-11" iyy="9.171e-4" iyz="6.112e-11"
                    izx="1.199e-6" izy="6.112e-11" izz="5.397e-4" />
        </inertial>
    </link>


    <!-- RIGHT CAMERA -->

    <joint name="right_camera_joint" type="revolute">
        <origin xyz="0.0 -0.05 0.1105" rpy="0.0 0.0 ${pi/2}" />
        <parent link="camera_base" />
        <child link="right_camera_link" />
        <axis xyz="1 0 0" />
        <limit
            upper="2.0"
            lower="1.0"
            effort="100"
            velocity="100" />
        <dynamics damping="10.0" friction="10.0" />
    </joint>

    <link name="right_camera_link">
        <visual>
            <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0"/>
            <geometry>
                <mesh filename="package://marinero_simulations/robot_description/meshes/Camera_L.stl" scale="1.0 1.0 1.0"/>
            </geometry>
            <material name="grey" />
        </visual>

        <collision>
            <origin xyz="-0.09 0.0 0.0"/>
            <geometry>
                <cylinder length="0.16" radius="0.066"/>
            </geometry>
        </collision>

        <inertial>
            <origin xyz="-0.089954 -0.002368 -0.003717" rpy="0.0 0.0 0.0" />
            <mass value="1.049" />
            <inertia ixx="0.002" ixy="1.096e-6" ixz="-8.789e-7"
                    iyx="1.096e-6" iyy="0.002" iyz="-1.039e-5"
                    izx="-8.789e-7" izy="-1.039e-5" izz="0.001" />
        </inertial>
    </link>

    <joint name="right_camera_center" type="fixed">
        <origin xyz="-0.09 0.0 0.065" rpy="0 ${-pi/2} ${-pi/2}"/>   <!-- xyz="-0.09 0.0 0.0635" -->
        <parent link="right_camera_link"/>
        <child link="right_camera_center_link"/>
    </joint>

    <link name="right_camera_center_link"></link>

    <joint name="right_camera_depth_joint" type="fixed">
        <origin xyz="0.0 0.0 0.0" rpy="${-pi/2} 0 ${-pi/2}"/>
        <parent link="right_camera_center_link"/>
        <child link="right_camera_depth_frame"/>
    </joint>

    <link name="right_camera_depth_frame"></link>


    <!-- LEFT CAMERA -->

    <joint name="left_camera_joint" type="revolute">
        <origin xyz="0.0 0.0515 0.1105" rpy="0.0 0.0 ${pi/2}" />
        <parent link="camera_base" />
        <child link="left_camera_link" />
        <axis xyz="1 0 0" />
        <limit
            upper="2.0"
            lower="1.0"
            effort="100"
            velocity="100" />
        <dynamics damping="10.0" friction="5.0" />
    </joint>

    <link name="left_camera_link">
        <visual>
            <origin xyz="0 0 0" rpy="0.0 0.0 0.0"/>
            <geometry>
                <mesh filename="package://marinero_simulations/robot_description/meshes/Camera_R.stl" scale="1.0 1.0 1.0"/>
            </geometry>
            <material name="grey" />
        </visual>

        <collision>
            <origin xyz="0.09 0.0 0.0"/>
            <geometry>
                <cylinder length="0.16" radius="0.066"/>
            </geometry>
        </collision>

        <inertial>
            <origin xyz="0.089953 0.002377 -0.004456" rpy="0.0 0.0 0.0"/>
            <mass value="1.039" />
            <inertia ixx="0.002" ixy="-1.101e-6" ixz="-8.812e-7"
                    iyx="-1.101e-6" iyy="0.002" iyz="-9.066e-6"
                    izx="-8.812e-7" izy="-9.066e-6" izz="0.001" />
        </inertial>
    </link>

    <joint name="left_camera_center" type="fixed">
        <origin xyz="0.09 0.01 0.06" rpy="0 ${-pi/2} ${-pi/2}"/>   <!-- xyz="0.09 0.01 0.0525" -->
        <parent link="left_camera_link"/>
        <child link="left_camera_center_link"/>
    </joint>

    <link name="left_camera_center_link"></link>

    <joint name="left_camera_depth_joint" type="fixed">
        <origin xyz="0.0 0.0 0.0" rpy="${-pi/2} 0.0 ${-pi/2}"/>   
        <parent link="left_camera_center_link"/>
        <child link="left_camera_depth_frame"/>
    </joint>

    <link name="left_camera_depth_frame"></link>


    <!-- GAZEBO PLUGINS -->

    <gazebo reference="right_camera_center_link">
        <sensor name="right_depth_camera" type="depth">
            <update_rate>50.0</update_rate>
            <visualize>false</visualize>
            <camera name="right_dep_cam">
                <horizontal_fov>1.3962634</horizontal_fov>
                <image>
                    <width>640</width>
                    <height>480</height>
                    <format>B8G8R8</format>
                </image>
                <clip>
                    <near>0.025</near>
                    <far>20</far>
                </clip>
            </camera>
            <plugin name="right_camera_controller" filename="libgazebo_ros_camera.so">
                <frame_name>right_camera_depth_frame</frame_name>
                <update_rate>50.0</update_rate>
                <min_depth>0.025</min_depth>
                <max_depth>20</max_depth>
            </plugin>
        </sensor>
    </gazebo>

    <!-- <gazebo reference="left_camera_center_link">
        <sensor name="left_depth_camera" type="depth">
            <update_rate>20</update_rate>
            <visualize>false</visualize>
            <camera name="left_dep_cam">
                <horizontal_fov>1.3962634</horizontal_fov>
                <image>
                    <width>640</width>
                    <height>480</height>
                    <format>B8G8R8</format>
                </image>
                <clip>
                    <near>0.1</near>
                    <far>25</far>
                </clip>
            </camera>
            <plugin name="left_camera_controller" filename="libgazebo_ros_camera.so">
                <frame_name>left_camera_depth_frame</frame_name>
                <imageTopicName>camera/image_left</imageTopicName>
                <depthImageTopicName>camera/depth_image_left</depthImageTopicName>
                <min_depth>0.1</min_depth>
                <max_depth>25</max_depth>
            </plugin>
        </sensor>
    </gazebo> -->

</robot>
